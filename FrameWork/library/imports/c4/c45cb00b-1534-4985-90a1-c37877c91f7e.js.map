{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\core/assets\\scripts\\core\\AudioMgr.js"],"names":["AudioMgr","cc","Class","extends","Component","properties","bgmVolume","sfxVolume","bgmAudioID","soundAudioID","musicState","init","Mgr","loadSound","t","sys","localStorage","getItem","parseFloat","game","on","EVENT_HIDE","console","log","audioEngine","pauseAll","EVENT_SHOW","resumeAll","getUrl","url","raw","playBGM","audioUrl","stop","play","playSFX","setSFXVolume","v","setItem","setBGMVolume","force","resume","pause","setVolume","getVoiceState"],"mappings":"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","file":"AudioMgr.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\core","sourcesContent":["/*\r\n*****Created By Alex 2018 08 24\r\n*/\r\nvar AudioMgr = cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        bgmVolume:1.0,\r\n        sfxVolume:1.0,\r\n        bgmAudioID:-1,\r\n        soundAudioID:-1,\r\n        musicState:1, //1 表示开启 0 表示关闭\r\n    },\r\n\r\n    // use this for initialization\r\n    init: function () {\r\n        cc.Mgr.loadSound = false;\r\n\r\n        var t = cc.sys.localStorage.getItem(\"bgmVolume\");\r\n        if(t != null){\r\n            this.bgmVolume = parseFloat(t);    \r\n        }\r\n        \r\n        var t = cc.sys.localStorage.getItem(\"sfxVolume\");\r\n        if(t != null){\r\n            this.sfxVolume = parseFloat(t);    \r\n        }\r\n        \r\n        cc.game.on(cc.game.EVENT_HIDE, function () {\r\n            console.log(\"cc.audioEngine.pauseAll\");\r\n            cc.audioEngine.pauseAll();\r\n        });\r\n        cc.game.on(cc.game.EVENT_SHOW, function () {\r\n            console.log(\"cc.audioEngine.resumeAll\");\r\n            cc.audioEngine.resumeAll();\r\n        });\r\n    },\r\n\r\n    //获取需要播放某个音效用  根据名字来\r\n    getUrl:function(url){\r\n        return cc.url.raw(\"resources/sound/\" + url + \".mp3\");\r\n    },\r\n\r\n    //播放背景音乐\r\n    playBGM:function(url){\r\n        var audioUrl = this.getUrl(url);\r\n        if(this.bgmAudioID >= 0){\r\n            cc.audioEngine.stop(this.bgmAudioID);\r\n        }\r\n        this.bgmAudioID = cc.audioEngine.play(audioUrl,true,this.bgmVolume);\r\n    },\r\n    //播放音效\r\n    playSFX:function(url){\r\n        var audioUrl = this.getUrl(url);\r\n        if(this.soundAudioID >= 0)\r\n        {\r\n            cc.audioEngine.stop(this.soundAudioID);\r\n        }\r\n        this.soundAudioID = cc.audioEngine.play(audioUrl,false,this.sfxVolume);\r\n    },\r\n    //设置音效大小\r\n    setSFXVolume:function(v){\r\n        if(this.sfxVolume != v){\r\n            cc.sys.localStorage.setItem(\"sfxVolume\",v);\r\n            this.sfxVolume = v;\r\n        }\r\n    },\r\n    //设置背景音大小\r\n    setBGMVolume:function(v,force){\r\n        if(this.bgmAudioID >= 0){\r\n            if(v > 0){\r\n                cc.audioEngine.resume(this.bgmAudioID);\r\n            }\r\n            else{\r\n                cc.audioEngine.pause(this.bgmAudioID);\r\n            }\r\n        }\r\n        if(this.bgmVolume != v || force){\r\n            cc.sys.localStorage.setItem(\"bgmVolume\",v);\r\n            this.bgmVolume = v;\r\n            cc.audioEngine.setVolume(this.bgmAudioID,v);\r\n        }\r\n    },\r\n    //暂停\r\n    pauseAll:function(){\r\n        this.musicState = 0;\r\n        this.bgmVolume = 0.0;\r\n        this.sfxVolume = 0.0;\r\n        cc.audioEngine.pauseAll();\r\n\r\n    },\r\n    //恢复\r\n    resumeAll:function(){\r\n        this.musicState = 1;\r\n        this.bgmVolume = 1.0;\r\n        this.sfxVolume = 1.0;\r\n        cc.audioEngine.resumeAll();\r\n    },\r\n\r\n    getVoiceState:function(){\r\n        return this.musicState;\r\n    },\r\n});\r\n"]}